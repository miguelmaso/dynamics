\documentclass{article}

\usepackage{fancyhdr}
\usepackage{parskip}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage{tikz}
\usepackage{pgfplots}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\lfoot{Miguel Mas√≥\\miguel.maso@upc.edu}
\rfoot{\today}

\pgfplotsset{width=7cm,compat=1.18}
\pgfplotsset{colormap={white}{color=(gray!20) color=(white)},
    colormap/white/.style={colormap name=white}}
\pgfplotsset{empty axes/.style={
    xtick=\empty,
    ytick=\empty,
    ztick=\empty}}
\pgfplotsset{white style/.style={
    surf,
    colormap/white,
    samples=5, % 5 for fast rendering, 20 for accurate rendering
    domain=0:1}}


\begin{document}

\section*{Natural frequencies of floor slabs}

\begin{wrapfigure}{l}{4cm}
\vspace{-1em}
\begin{tikzpicture}
\draw [fill=gray!30] coordinate (O) rectangle (3,2) coordinate (P);
\path (O) -- node [midway,below] {$l_x$} (O -| P);
\path (O -| P) -- node [midway,right] {$l_y$} (P);
\end{tikzpicture}
\end{wrapfigure}

A simply supported rectangular floor of thickness $t$ is considered. The material properties are density $\rho$, Young's modulus $E$ and Poissins's ratio $\nu$. The flexural stiffness is
$$
D = \frac{Et^3}{12(1-\nu^2)}
$$

The frequencies are estimated using the Rayleig's method with an appropriate shape function $\psi$, being $n$ and $m$ the $i^{th}$ mode of vibration for the $x$ and $y$ directions.
$$
\psi = \sin\left(\frac{\pi nx}{l_x}\right) \sin\left(\frac{\pi my}{l_y}\right)
$$

The modal mass is
\begin{multline*}
m_\psi = \int_0^{l_y}\int_0^{l_x} \rho t \psi^2 dxdy =
\int_0^{l_y}\int_0^{l_x} \rho t \sin^2\left(\frac{\pi nx}{l_x}\right) \sin^2\left(\frac{\pi my}{l_y}\right) dxdy = \\
= \rho t \int_0^{l_x} \sin^2\left(\frac{\pi nx}{l_x}\right) dx \int_0^{l_y} \sin^2\left(\frac{\pi my}{l_y}\right) dy =
\frac{\rho t l_x l_y}{4mn}.
\end{multline*}

The modal stiffness is
\begin{multline*}
m_\psi = \int_0^{l_y}\int_0^{l_x} D \psi''^2 dxdy = \dots\\
= \frac{\pi^4D}{4}\left(\frac{l_yn^3}{l_x^3m} + \frac{l_xm^3}{l_y^3m} + \frac{2mn}{l_xl_y}\right)
\end{multline*}


\begin{tikzpicture}
    \begin{axis}[empty axes, title=Mode 1]
        \addplot3 [white style] {sin(180*x) * sin(180*y)};
    \end{axis}
\end{tikzpicture}
\begin{tikzpicture}
    \begin{axis}[empty axes,title=Mode 2]
        \addplot3 [white style] {sin(360*x) * sin(180*y)};
    \end{axis}
\end{tikzpicture}

\begin{tikzpicture}
    \begin{axis}[empty axes,title=Mode 3]
        \addplot3 [white style] {sin(180*x) * sin(360*y)};
    \end{axis}
\end{tikzpicture}
\begin{tikzpicture}
    \begin{axis}[empty axes,title=Mode 4]
        \addplot3 [white style] {sin(360*x) * sin(360*y)};
    \end{axis}
\end{tikzpicture}


\end{document}