<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>

<h3>
<math display="inline">
  <mi>H</mi><mo>=</mo>
  <msqrt>
    <mfrac>
      <!-- Numerador -->
      <mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <msup><mi>&eta;</mi><mn>2</mn></msup>
            <mo>−</mo>
            <msup><mi>&gamma;</mi><mn>2</mn></msup>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>+</mo>
        <mn>4</mn>
        <msup><msub><mi>&xi;</mi><mi>d</mi></msub><mn>2</mn></msup>
        <msup><mi>&gamma;</mi><mn>2</mn></msup>
        <msup><mi>&eta;</mi><mn>2</mn></msup>
      </mrow>

      <!-- Denominador -->
      <mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>(</mo>
              <msup><mi>&eta;</mi><mn>2</mn></msup>
              <mo>−</mo>
              <msup><mi>&gamma;</mi><mn>2</mn></msup>
              <mo>)</mo>
            </mrow>
            <mo>(</mo>
            <mn>1</mn><mo>−</mo><msup><mi>&gamma;</mi><mn>2</mn></msup>
            <mo>)</mo>
            <mo>−</mo>
            <mi>&rho;</mi>
            <msup><mi>&gamma;</mi><mn>2</mn></msup>
            <msup><mi>&eta;</mi><mn>2</mn></msup>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>

        <mo>+</mo>

        <msup>
          <mrow>
            <mo>(</mo>
            <mn>2</mn>
            <msub><mi>&xi;</mi><mi>d</mi></msub>
            <mi>&gamma;</mi>
            <mi>&eta;</mi>
            <mo>(</mo>
            <mn>1</mn><mo>−</mo>
            <msup><mi>&gamma;</mi><mn>2</mn></msup>
            <mo>(</mo><mn>1</mn><mo>+</mo><mi>&rho;</mi><mo>)</mo>
            <mo>)</mo>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
      </mrow>
    </mfrac>
  </msqrt>

  <!-- definiciones -->
  <mspace width="1em"/>
  <mo>,</mo>
  <mspace width="0.5em"/>
  <mi>&rho;</mi><mo>=</mo>
  <mfrac><msub><mi>m</mi><mi>d</mi></msub><mi>m</mi></mfrac>
  <mo>,</mo>
  <mspace width="0.5em"/>
  <mi>&eta;</mi><mo>=</mo>
  <mfrac><msub><mi>&omega;</mi><mi>d</mi></msub><mi>&omega;</mi></mfrac>
</math>
</h3>


<label>ρ = <span id="rho_tag"></span></label><br>
<input type="range" id="rho" min="0" max="0.1" step="0.001" value="0.05" style="width:300px;"><br>
<label>η = <span id="eta_tag"></span></label><br>
<input type="range" id="eta" min="0.9" max="1.05" step="0.001" value="0.975" style="width:300px;"><br>
<label>ξd = <span id="xi_tag"></span></label><br>
<input type="range" id="xi" min="0" max="0.2" step="0.001" value="0.10" style="width:300px;"><br>

<div id="plot" style="width:800px;height:400px;"></div>

<script>
function updatePlot() {
    
    let rho = parseFloat(document.getElementById("rho").value);
    document.getElementById("rho_tag").innerHTML = rho;
    let eta = parseFloat(document.getElementById("eta").value);
    document.getElementById("eta_tag").innerHTML = eta;
    let xi = parseFloat(document.getElementById("xi").value);
    document.getElementById("xi_tag").innerHTML = xi;

    let x = [];
    let y = [];
    let z = [];
    for (let i=0; i<=3; i+=0.01) {
        a = eta**2 - i**2;
        b = 2*xi*i*eta;
        c = a**2 + b**2;
        d = (a*(1-i**2) -rho*i**2*eta**2)**2 + b**2*(1-i**2*(1+rho))**2;
        
        f = Math.abs(1 - i*i);

        x.push(i);
        y.push(Math.sqrt(c/d));
        z.push((f < 5e-2) ? NaN : 1/f);
    }

    Plotly.newPlot("plot", [
      {
        x: x,
        y: y,
        name: "H",
        mode: "lines"
      },{
        x: x,
        y: z,
        name: "no mass damper",
        mode: "none",
        fill: "tozeroy",
        fillcolor: "rgba(200,50,50,0.2)",
        hoverinfo: "none"
      }
    ], {
        margin: { t: 10 },
        dragmode: false
    });
}

document.getElementById("rho").addEventListener("input", updatePlot);
document.getElementById("eta").addEventListener("input", updatePlot);
document.getElementById("xi").addEventListener("input", updatePlot);

updatePlot();
</script>

</body>
</html>
